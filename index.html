<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ai chat ui</title>
    <link rel="stylesheet" href="./reset.css" />
    <link rel="stylesheet" href="./style.css" />
    <link rel="stylesheet" href="./ai-chat.css" />
    <link rel="stylesheet" href="./ai-summary.css" />
  </head>
  <body>
    <div class="inner">
      <section>
        <div class="ai-summary-title">AI 핵심 요약</div>
        <div id="summary-box"></div>
      </section>

      <hr />

      <section>
        <div id="chat-box"></div>
        <form id="chat-form">
          <input
            type="text"
            id="chat-input"
            placeholder="질문을 입력하세요..."
          />
          <button type="submit">전송</button>
        </form>
      </section>
    </div>

    <!-- 마크다운 파싱 라이브러리 필수-->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="./ai-core.js"></script>
    <script src="./ai-chat.js"></script>
    <script src="./ai-summary.js"></script>
    <script>
      // 1. 챗봇 서비스 사용
      const chatService = new AIChat("#chat-box", {
        endpoint: "/api/chat",
      });

      const chatForm = document.querySelector("#chat-form");
      const chatInput = document.querySelector("#chat-input");

      chatForm.addEventListener("submit", async (e) => {
        e.preventDefault();

        const userInput = chatInput.value.trim();
        if (!userInput) return;

        chatInput.value = "";

        await chatService.submitQuestion({
          // payload 형태는 backend API 요구사항에 맞게 작성
          payload: {
            model: "gpt-4",
            messages: [{ role: "user", content: userInput }],
            stream: true,
          },
          callbacks: {
            onStart: () => {
              console.log("질문 시작!");
            },
            onComplete: () => {
              console.log("답변 완료!");
            },
          },
        });
      });
    </script>
    <script>
      // 2. 요약 서비스 사용 (질문형)
      const summaryService = new AISummary("#summary-box", {
        endpoint: "/api/summary",
      });

      summaryService.start({
        // payload 형태는 backend API 요구사항에 맞게 작성
        payload: {},
        callbacks: {
          onStart: () => {
            console.log("요약 시작!");
          },
          onComplete: () => {
            console.log("요약 완료!");
          },
        },
      });
    </script>
  </body>
</html>
